apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector-webhook-cfg
  labels:
    app: sidecar-injector
webhooks:
  - name: com.epam.admission-registry-mutate
    clientConfig:
      service:
        name: admission-registry
        namespace: default
        path: "/mutate"
      caBundle: |
        LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR2akNDQXFhZ0F3SUJBZ0lVVTU2QkNHaHBt
        TUtHeFJXRzNSUUhFVW53UThrd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pURUxNQWtHQTFVRUJoTUNR
        MDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbAphVXBwYm1jeEREQUtC
        Z05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByCmRXSmxj
        bTVsZEdWek1CNFhEVEl4TURrd016QTBNamN3TUZvWERUSTJNRGt3TWpBME1qY3dNRm93WlRFTE1B
        a0cKQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbGFV
        cHBibWN4RERBSwpCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZR
        UURFd3ByZFdKbGNtNWxkR1Z6Ck1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNn
        S0NBUUVBdTlJU2I0cWUzNUNoSTZXckY0K1UKQ1p4VlU2MHpDQ3d6UE1HNGNXeTlaSW5hb3JWVUQ4
        aFV0TSsrTTBhTUtmU3dOaHhtWnlSamIzaE93MXVNMS9DcgpGUU5mUS9GWTdMM1lvS2k5cTJmUWVD
        ajBnRjUvRG5Jc3lSdm0zWWFPOXg5eU9BTXBoMDJ5NUR4czZFY0xLcTQ3CmtoZjNGNmplTUFWVWxn
        aGt4Mm8vSi9hQXBVYXhtbzg2Y0JZS2VzNzVZb1VORTNMNzRLWExwQmtjekp0SUVSSGQKaHhuM2ZD
        ZDFqKzlVdWQycDVMODErL1ByYjZmMDloaHd5a0FKSHdQWHZlTHU4WDdZSmd0YnJpSk1XSEpkNWt0
        SgpHYXVmYlN0WStjM2RnTHk0TjBoakpHZkw0YmJLSWJBMGlaZCswYXhVSEtsUHBsclhLaDVBRUZl
        c2c5a2FiVlZiCmF3SURBUUFCbzJZd1pEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VnWURWUjBUQVFI
        L0JBZ3dCZ0VCL3dJQkFqQWQKQmdOVkhRNEVGZ1FVSFg0TldzY3o4OXVTZTVabTdMODFXOTl6NElB
        d0h3WURWUjBqQkJnd0ZvQVVIWDROV3Njego4OXVTZTVabTdMODFXOTl6NElBd0RRWUpLb1pJaHZj
        TkFRRUxCUUFEZ2dFQkFDTkV3K1FqeUJsT1NlcjZCTFYrCkxvU0tUdHRBQTllSS8yUzF2dUM0ODIx
        Mm9aQTg5bTVuRGt3Tm9RRDhtU3MyWWx3am80a3ovblVkSGF0My9DMVMKQ3dFNTdrQW9Cam5vdHdE
        V0hRQnV3QzVHamM3QjRnenB4Ny8zOXd5SjBOL2x5MEVmd3NlbUNhNUhvNWIxY2lxWQppS0tTd05H
        OERWZDRsTWxZQ1BWUVRSUC90MHVlMDBCbnNSVCtoTUxONFZzakNpS1djRk9OcStlaDJnV2ZvQWRE
        CnBJTkI1N0NXZjAzaTJMUlZROGZZNngvbFd3VnVCQ01XUE1PQk0vd0VBS3pCeTdxU0hIWFNYT2ZP
        ZXBYWEliS1AKL1ErZEdMMTR4WE9oMmxTd0pSS3RwWEF4OU5Sc3hNZjN4Q0hjY09nUWg5cWs5S1N6
        QmhoZWNuYmdnbmxLL2tEcgpUc009Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
      - operations: [ "CREATE" ]
        apiGroups: ["apps", ""]
        apiVersions: ["v1"]
        resources: ["deployments","statefulsets"]
    admissionReviewVersions: [ "v1" ]
    sideEffects: None
    namespaceSelector:
      matchLabels:
        sidecar-injection: enabled
