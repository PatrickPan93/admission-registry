apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector-webhook-cfg
  labels:
    app: sidecar-injector
webhooks:
  - name: com.epam.admission-registry-mutate
    clientConfig:
      service:
        name: admission-registry
        namespace: default
        path: "/mutate"
      caBundle: |
        LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR2akNDQXFhZ0F3SUJBZ0lVSXFVUWE2SWdJ
        dzVUWXFpcW02cSt3dmgxVyswd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pURUxNQWtHQTFVRUJoTUNR
        MDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbAphVXBwYm1jeEREQUtC
        Z05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByCmRXSmxj
        bTVsZEdWek1CNFhEVEl4TURrd016QTBNekV3TUZvWERUSTJNRGt3TWpBME16RXdNRm93WlRFTE1B
        a0cKQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbGFV
        cHBibWN4RERBSwpCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZR
        UURFd3ByZFdKbGNtNWxkR1Z6Ck1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNn
        S0NBUUVBM081YkVxZkJZa2U2OWZpZFRWbzIKaTFCQ2x4enU1ZXhRcG56MXZvN2crQmUrMm4yVGVW
        d2lNYjJvSGVwL2I4Ly90aEtMWFRIQ2d5ZGpBaCtqU1hkdQo0aEdnM3dkMFBaREYvai9ORTg2MHhF
        eDRtc200MGE1aTkxSUI3dFdHSi9rVXB1ZEc1STBpYklDMHNQU1hzdGo2CkhmOW1YRS93SCttYkdh
        bExuNm5McEc3dmE0STZFMmt2Y2RFZFBrZGduQzd2NjJjeDRlQnF1blRnVHVPb3F5SVgKeXV2eEM0
        ZnBEaW9TMXdXTTN3YlAxSC9jOTlRaXpLWWRtMlpXKzZyZWFaS1o2cm5BSXltOHRJSDNjcll6UTNl
        Vgp2ZWRlMDFqMjU5R2ZWQ3RNTjZLdlV2T3pHc1BseUFhcmY0ekk5UzJpbmxXVjE2NXI4NHpaNW93
        eUJuaWt5QldkCkt3SURBUUFCbzJZd1pEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VnWURWUjBUQVFI
        L0JBZ3dCZ0VCL3dJQkFqQWQKQmdOVkhRNEVGZ1FVS1kveHFrZTJ1NDdGN2xBYlVNZitkRzk4UXh3
        d0h3WURWUjBqQkJnd0ZvQVVLWS94cWtlMgp1NDdGN2xBYlVNZitkRzk4UXh3d0RRWUpLb1pJaHZj
        TkFRRUxCUUFEZ2dFQkFBK3JxTWpsTkxlaVVWQU0wWFBwCkZmT2ZNd0pQUXcxU01HZU5LMHFaTTI1
        OUVEdmZ2aU9ISlZZTVFMc0FDY2IzajYrNVJ3K0ZLQW9wY2doYTE0WlMKcUg3V1Flb2RxZXk0ZjF2
        NVJ3Y0xWaEJsYWk0OGhZb2Uzb0duNHBURUZZTlhPZUNjSFZCVXlRL0R0c1NIbHB3SwpYbHpDOWZG
        NEZTUnR6K2RFcjM0K2ZyR1VYclRvRVc1dGpsc3czSnVPQi9GV1g5T3BGS3Jhd2FhWjdMMnVoOUNQ
        CjRYdE13ZzRkbzZNRklmWlhLUjRCZ2JiT29SVDR5eDBvTEdHVWp2aHBsVVA3Sm95R29Ga3JTS3Qx
        aERMMHF3elEKdW5EQW85V3l6RkZRSDlxR202MFB6NmtPaGYvVTU4V1paVG03SW1uMlhRUC90bXRI
        Mi9OTFJLUlpKR1hPZkZLdgpVZ289Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
      - operations: [ "CREATE" ]
        apiGroups: ["apps", ""]
        apiVersions: ["v1"]
        resources: ["deployments","statefulsets"]
    admissionReviewVersions: [ "v1" ]
    sideEffects: None
    namespaceSelector:
      matchLabels:
        sidecar-injection: enabled
